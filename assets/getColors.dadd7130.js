var f=Object.defineProperty;var v=(l,e,o)=>e in l?f(l,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[e]=o;var g=(l,e,o)=>(v(l,typeof e!="symbol"?e+"":e,o),o);(function(){"use strict";class l{constructor(s){g(this,"totalPixelCount",0);g(this,"averageColor",{r:0,g:0,b:0});g(this,"tolerance",100);this.tolerance=s}getColorCount(){return this.totalPixelCount}getAverageColor(){return this.averageColor}isColorInGroup(s,n,C){return this.totalPixelCount===0?!0:(this.averageColor.r-s)**2+(this.averageColor.g-n)**2+(this.averageColor.b-C)**2<=this.tolerance**2}addColor(s,n,C){this.averageColor.r=(this.averageColor.r*this.totalPixelCount+s)/(this.totalPixelCount+1),this.averageColor.g=(this.averageColor.g*this.totalPixelCount+n)/(this.totalPixelCount+1),this.averageColor.b=(this.averageColor.b*this.totalPixelCount+C)/(this.totalPixelCount+1),this.totalPixelCount+=1}}function e(o){const n=[new l(120)],C=[];for(let t=0;t<o.length;t+=4){let r=o[t],i=o[t+1],a=o[t+2],c=o[t+3],h=!1;c===0&&(r=255,i=255,a=255);for(const u of n)if(u.isColorInGroup(r,i,a)){u.addColor(r,i,a),h=!0;break}if(!h){const u=new l(120);u.addColor(r,i,a),n.push(u)}}n.sort((t,r)=>t.getColorCount()>r.getColorCount()?-1:t.getColorCount()<r.getColorCount()?1:0);for(const t of n){const r=t.getAverageColor();C.push({r:Math.round(r.r),g:Math.round(r.g),b:Math.round(r.b),pixelsCount:t.getColorCount(),percentage:100*t.getColorCount()/(.25*o.length)})}return C}onmessage=o=>{postMessage(e(o.data))}})();
